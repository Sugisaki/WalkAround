# 画面遷移とUI構成

WalkAround は、レスポンシブなナビゲーションと、計測データに基づいたドリルダウン形式の画面遷移を採用しています。

## 1. ナビゲーション構造

`NavigationSuiteScaffold` を使用することで、デバイスの画面サイズや向きに応じて最適なナビゲーション UI を提供します。
-   **スマートフォン（縦持ち）**: 画面下部の「ボトムナビゲーション」。
-   **タブレット・横持ち**: 画面左側の「ナビゲーションレール」。

## 2. 各画面の役割 (AppDestinations)

### Home (ホーム)
-   **履歴一覧**: 過去の計測セッション（`Section`）をリスト表示します。
-   **計測操作**: 「開始」「停止」ボタンにより `TrackingService` を制御します。
-   **リアルタイム表示**: 計測中は、現在の歩数や位置情報取得件数がリアルタイムに更新されます。

### Route (ルート詳細)
-   **住所履歴**: 選択されたセッション中に通過した住所（`AddressRecord`）をタイムライン形式で表示します。
-   **ドリルダウン**: 特定の住所をタップすることで、その地点を Map 画面で確認できます。

### Map (地図)
-   **軌跡の描画**: Google Maps 上に計測した `TrackPoint` を結んだポリラインを描画します。
-   **現在地追従**: 計測中の場合は、最新の位置にカメラが自動追従します。

### Settings (設定)
-   **精度制限**: 位置情報の精度フィルタリングしきい値（メートル）の設定。
-   **音声案内**: 案内読み上げの ON/OFF 切り替え。
-   **テーマ設定**: ライト/ダークモード、およびシステム設定への追従。

## 3. 画面間のデータ連携

画面遷移と状態管理は主に `MainActivity` と各 `ViewModel` で行われます。

### セッションIDの共有
-   `MainActivity` は `selectedSectionId` という状態を保持します。
-   **Home** で履歴をタップすると `selectedSectionId` がセットされ、**Route** または **Map** へ遷移します。
-   この ID をキーにして、各 ViewModel（`RouteViewModel`, `MapViewModel`）が Room データベースから必要な Flow を購読（subscribe）します。

### リアクティブな更新
全ての画面は Room の `Flow` を監視しています。そのため、バックグラウンドの `TrackingService` がデータを更新すると、ユーザーが操作することなく UI に反映されます。
